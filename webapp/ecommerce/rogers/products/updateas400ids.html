<div class="ui-widget uipanel">
	<div id="updates_title" class="ui-widget-header">[[Rogers AS400 Import - In Progress]]</div>
	<div class="ui-widget-content">
		<h3 id="updates_h3">Updates in Progress <img src="/${applicationid}/theme/images/ajax-loader.gif"></h3>
		<p id="updates_paragraph">Updates are in progress. This may take several minutes. Once the updates are complete, the page will refresh.</p>
	</div>
</div>

#if($uuid)
	#set($D = "$")
	<script>
	$(document).ready(function(){
		startTimer();
	});
	
	function startTimer(){
		setTimeout(function(){timerexpired();}, 15000);//check every 15 seconds
	}
	
	function timerexpired(){
		${D}.ajax({
			url : "$home$apphome/rogers/products/checkstatus.html?oemaxlevel=1&uuid=$uuid",
			type: "GET",
			success:function(data, textStatus, jqXHR){
				if (data.trim() === "Complete"){
					$("#updates_title").html("Rogers AS400 Import - Complete");
					$("#updates_h3").html("Updates Complete");
					$("#updates_paragraph").html("AS400 IDs were updated on all affected products.");
				} else if (data.trim() === "Error"){
					$("#updates_title").html("Rogers AS400 Import - Error");
					$("#updates_h3").html("Updates Complete");
					$("#updates_paragraph").html("AS400 IDs were unable to complete because of an error. Try importing the AS400 IDs again.");
				} else {
					startTimer();
				}
			}
		});
	}
	</script>
#end