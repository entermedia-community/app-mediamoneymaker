#set($showsidebar = false)
#if($canbrowseproducts)

	#set($searchroot = "$apphome/search")
	#set($showsidebar = "true")

#elseif($canviewdistributorsection)
	#set($searchroot = "$apphome/distributors")
	#set($showsidebar = "true")
	#if(!$canbrowseproducts)
		#set($extra = "&field=distributor&distributor.value=$userprofile.distributor&operation=matches")
	#end
#end                                    


##$pages.stream("$apphome/search/search.html")
#if($showsidebar =="true")
  <div class="ui-widget-header">Categories</div>
	           <div class="ui-widget-content categories-widget no-padding-for-real">
	               <ul id="settings-menu" class="sidebar-list">
  
          
                ##set($mans = $searcherManager.getList("media/catalogs/store", "categoryid"))
               	#set($mans = $searcherManager.getSearcher("media/catalogs/store", "categoryid").fieldSearch("id", "*", "name"))
               	
          	#foreach($man in $mans)
			
                	<li #if($velocityCount > 5) class="hidden-item categories"   #end><a href="$searchroot/fieldsearch.html?field=categoryid&categoryid.value=$man.id&operation=exact$!extra">$man.name</a></li>
                	
                	#end
                	#if($mans.size() > 5)
                	<li > <a  class="showall" data-id="categories" href="#">Show all...</a></li>
			#end
                </ul>
                </div>


 <div class="ui-widget-header">Phone Compatability</div>
	           <div class="ui-widget-content categories-widget no-padding-for-real">
	               <ul id="settings-menu" class="sidebar-list">
  
          
                ##set($mans = $searcherManager.getList("media/catalogs/store", "phone"))
              
              
              
            #set($phonesearcher = $searcherManager.getSearcher("media/catalogs/store", "phone"))
            #set($mansearcher = $searcherManager.getSearcher("media/catalogs/store", "manufacturer"))
            #set($mans = $mansearcher.fieldSearch("id", "*", "name"))
            #set($mancount = 0)   
          	#foreach($man in $mans)
           		<!-- 
           		#set($query = $phonesearcher.createSearchQuery().append("manufacturer", "${man.id}").append("active", "true"))
           		 -->
           		#set($phones = $phonesearcher.search($query))
               	#if($phones.size() >0)
               		#set($mancount = $mancount+1)
               		
               		<li class="search-sidebar-header"> <span style="padding-top:4px;">  $man </span> </li>
          			#set($phonecount = 0)   
          			       			
          			#foreach($phone in $phones)						
						#set($phonecount = $phonecount+1)
						
						<li #if($phonecount > 3)  class="hidden-item show-${man.id}"    #end><a href="$searchroot/fieldsearch.html?field=phone&phone.value=$phone.id&operation=exact$!extra">$phone.name</a></li>                	
                	#end                	
				#end
				#if($phones.size()  > 3)
				<li > <a  style="font-size: .7em; font-style: italic;" class="showall" data-id="show-${man.id}" href="#">&nbsp;More $man</a></li>
				#end
				#set($phones = "")
				
			#end
			    
			
                </ul>
                </div>





 <div class="ui-widget-header">Manufacturers</div>
	           <div class="ui-widget-content categories-widget no-padding-for-real">
	               <ul id="settings-menu" class="sidebar-list">
  
          
                #set($mans = $searcherManager.getList("media/catalogs/store", "manufacturer"))
               
          	#foreach($man in $mans)
                	<li #if($velocityCount > 5)  class="hidden-item manu"  #end ><a href="$searchroot/fieldsearch.html?field=manufacturerid&manufacturerid.value=$man.id&operation=exact$!extra">$man.name</a></li>
               
                	
			
                	
                	#end
                	#if($mans.size() > 5)
                	<li > <a  class="showall" data-id="manu" href="#">Show all...</a></li>
                	
                	
			#end
                </ul>
                </div>
                
            <script type="text/javascript">
            
            jQuery(document).ready(function (){
            	jQuery(".hidden-item").hide();
                
            	jQuery(".showall").bind('click', function() 
            	{
		            	var id = jQuery(this).data("id");
		            	
		            	jQuery("." + id).toggle(500);
		            	if(jQuery(this).text() == "Show all..." || jQuery(this).text().indexOf("More") != -1)
		            	
		            	jQuery(this).text("Show less..");
		            	else{		            		
		            		jQuery(this).text("Show all...");
		            	}
		            	
		            	return false;
		            	
		        });
            	
            	
            });
            
            </script>

#end